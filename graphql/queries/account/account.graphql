query getUserAddressById($id: uuid = "") {
  user_by_pk(id: $id) {
    user_addresses {
      address
      address_title
      receiver_firstname
      receiver_phone
      receiver_surname
      id
      city {
        id
        name
        code
      }
      district {
        id
        name
        code
      }
      quarter {
        id
        name
        code
      }
    }
  }
}

query getUserById($id: uuid = "") {
  user_by_pk(id: $id) {
    id
    created_at
    email
    firstname
    lastname
    picture
    phone
    reference_code
    user_addresses {
      address_title
      address
    }
    carts {
      id
      content
    }
  }
}

mutation updateUserById(
  $id: uuid!
  $firstname: String
  $lastname: String
  $phone: String
  $picture: String
) {
  update_user_by_pk(
    pk_columns: { id: $id }
    _set: {
      firstname: $firstname
      lastname: $lastname
      phone: $phone
      picture: $picture
    }
  ) {
    email
    firstname
    lastname
    phone
    picture
  }
}

query getCities {
  cities: city {
    code
    id
    name
  }
}

query getDistricts($cityId: Int = 10) {
  districts: district(where: { city: { id: { _eq: $cityId } } }) {
    name
    id
  }
}

query getQuarters($districtId: Int = 1) {
  quarters: quarter(where: { district: { id: { _eq: $districtId } } }) {
    name
    id
  }
}

query GetQuarterById($id: Int) @cached {
  quarter(where: { id: { _eq: $id } }) {
    code
    id
    name
    district {
      id
      code
      name
      city {
        code
        id
        name
      }
    }
  }
}

query getDistrictById($id: Int) @cached {
  district(where: { id: { _eq: $id } }) {
    code
    id
    name
    city {
      name
      id
    }
  }
}

query getCityById($id: Int) {
  city(where: { id: { _eq: $id } }) {
    code
    id
    name
  }
}

query getDistrictForProduct($cityId: Int!, $pid: bigint!) {
  district(
    where: {
      _and: [
        { city: { id: { _eq: $cityId } } }
        {
          quarters: {
            tenant_shipping_places: {
              tenant: { owner: { products: { id: { _eq: $pid } } } }
            }
          }
        }
      ]
    }
  ) {
    name
    id
    code
  }
}

query getQuartersForProduct($pid: bigint!, $districtId: Int!) {
  quarter(
    where: {
      _and: [
        { district: { id: { _eq: $districtId } } }
        {
          tenant_shipping_places: {
            tenant: { owner: { products: { id: { _eq: $pid } } } }
          }
        }
      ]
    }
  ) {
    id
    name
    code
  }
}

query getUserOrders {
  order(where: { payment_status: { _eq: PAID } }) {
    created_at
    id
    total_amount
    tenant_orders {
      id
      tenant {
        id
        tenants {
          name
          id
        }
      }
      order_items {
        id
        order_item_no
        product_id
        quantity
        order_item_special_images {
          image_url
          quantity_index
          id
        }
        order_item_special_texts {
          content
          quantity_index
          id
        }
        product {
          product_categories {
            category {
              name
              slug
            }
          }
          slug
          image_url
          name
          quantity
          product_customizable_areas {
            count
            max_character
            customizable_area {
              id
              type
            }
          }
        }
      }
      order_status {
        value
      }
      order_items_aggregate {
        aggregate {
          count(columns: id)
        }
      }
    }
  }
}

mutation createNewAddress(
  $address: String
  $address_title: String
  $city_id: Int
  $district_id: Int
  $quarter_id: Int
  $receiver_firstname: String
  $receiver_phone: String
  $receiver_surname: String
  $user_id: uuid
) {
  insert_user_address_one(
    object: {
      address: $address
      address_title: $address_title
      city_id: $city_id
      district_id: $district_id
      quarter_id: $quarter_id
      receiver_firstname: $receiver_firstname
      receiver_phone: $receiver_phone
      receiver_surname: $receiver_surname
      user_id: $user_id
    }
  ) {
    address_title
    id
  }
}

query getUserByEmail($email: String!) {
  user(where: { email: { _eq: $email } }) {
    id
    provider_id
  }
}

query GetLocationQuery($search: String = "") @cached {
  search_locationv1(args: { search: $search }, limit: 100) {
    id
    name
    type
    district_id
    district_name
    city_id
    city_name
  }
}

mutation UpdateOrderItemSpecialText(
  $object: [order_item_special_text_insert_input!]!
) {
  insert_order_item_special_text(
    objects: $object
    on_conflict: {
      constraint: order_item_special_text_pkey
      update_columns: [content]
    }
  ) {
    affected_rows
  }
}
